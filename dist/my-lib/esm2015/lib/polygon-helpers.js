import { PolygonUtil } from "./polygon.util";
export class PolygonInfo {
    constructor(polygon) {
        this.polygon = [];
        this.trashcanPoint = [];
        this.sqmArea = [];
        this.perimeter = [];
        console.log("PolygonInfo: ", polygon);
        polygon.forEach((polygons, i) => {
            this.trashcanPoint[i] = this.getTrashcanPoint(polygons[0]);
            this.sqmArea[i] = this.calculatePolygonArea(polygons[0]);
            this.perimeter[i] = this.calculatePolygonPerimeter(polygons[0]);
            console.log(polygons[0]);
            this.polygon[i] = polygons;
        });
    }
    setSqmArea(area) {
        this.sqmArea[0] = area;
    }
    getTrashcanPoint(polygon) {
        const res = Math.max.apply(Math, polygon.map(o => o.lat));
        const idx = polygon.findIndex(o => o.lat === res);
        let previousPoint;
        let nextPoint;
        if (idx > 0) {
            previousPoint = polygon[idx - 1];
            if (idx < polygon.length - 1) {
                nextPoint = polygon[idx + 1];
            }
            else {
                nextPoint = polygon[0];
            }
        }
        else {
            previousPoint = polygon[polygon.length - 1];
            nextPoint = polygon[idx + 1];
        }
        const secondPoint = (previousPoint.lng < nextPoint.lng) ? previousPoint : nextPoint;
        const midpoint = PolygonUtil.getMidPoint(polygon[idx], secondPoint);
        return midpoint;
    }
    calculatePolygonArea(polygon) {
        const area = PolygonUtil.getSqmArea((polygon));
        return area;
    }
    calculatePolygonPerimeter(polygon) {
        const perimeter = PolygonUtil.getPerimeter((polygon));
        return perimeter;
    }
}
export class PolygonDrawStates {
    constructor() {
        this.canUsePolyDraw = false;
        this.reset();
    }
    activate() {
        this.reset();
        this.isActivated = true;
    }
    reset() {
        this.isActivated = false;
        this.hasPolygons = false;
        this.canRevert = false;
        this.isAuto = false;
        this.resetDrawModes();
    }
    resetDrawModes() {
        this.isFreeDrawMode = false;
        this.isMoveMode = false;
    }
    setFreeDrawMode(isAuto = false) {
        if (isAuto) {
            this.isActivated = true;
        }
        if (this.isActivated) {
            this.resetDrawModes();
            this.isFreeDrawMode = true;
            if (isAuto) {
                this.isAuto = true;
            }
        }
    }
    setMoveMode() {
        if (this.isActivated) {
            this.resetDrawModes();
            this.isMoveMode = true;
        }
    }
    forceCanUseFreeDraw() {
        this.canUsePolyDraw = true;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG9seWdvbi1oZWxwZXJzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vbXktbGliLyIsInNvdXJjZXMiOlsibGliL3BvbHlnb24taGVscGVycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFN0MsTUFBTSxPQUFPLFdBQVc7SUFLcEIsWUFBWSxPQUFPO1FBSm5CLFlBQU8sR0FBa0IsRUFBRSxDQUFDO1FBQzVCLGtCQUFhLEdBQWMsRUFBRSxDQUFDO1FBQzlCLFlBQU8sR0FBYSxFQUFFLENBQUM7UUFDdkIsY0FBUyxHQUFhLEVBQUUsQ0FBQztRQUVyQixPQUFPLENBQUMsR0FBRyxDQUFDLGVBQWUsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN0QyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDMUYsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsb0JBQW9CLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDekQsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMseUJBQXlCLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN6QixJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxHQUFHLFFBQVEsQ0FBQTtRQUM5QixDQUFDLENBQUMsQ0FBQTtJQUVOLENBQUM7SUFDRCxVQUFVLENBQUMsSUFBWTtRQUNuQixJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQztJQUMzQixDQUFDO0lBQ08sZ0JBQWdCLENBQUMsT0FBa0I7UUFFdkMsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUMxRCxNQUFNLEdBQUcsR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsS0FBSyxHQUFHLENBQUMsQ0FBQztRQUVsRCxJQUFJLGFBQXNCLENBQUM7UUFDM0IsSUFBSSxTQUFrQixDQUFDO1FBRXZCLElBQUksR0FBRyxHQUFHLENBQUMsRUFBRTtZQUNULGFBQWEsR0FBRyxPQUFPLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDO1lBQ2pDLElBQUksR0FBRyxHQUFHLE9BQU8sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO2dCQUMxQixTQUFTLEdBQUcsT0FBTyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQzthQUNoQztpQkFBTTtnQkFDSCxTQUFTLEdBQUcsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQzFCO1NBQ0o7YUFBTTtZQUNILGFBQWEsR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQztZQUM1QyxTQUFTLEdBQUcsT0FBTyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQztTQUNoQztRQUVELE1BQU0sV0FBVyxHQUFHLENBQUMsYUFBYSxDQUFDLEdBQUcsR0FBRyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO1FBRXBGLE1BQU0sUUFBUSxHQUFHLFdBQVcsQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFLFdBQVcsQ0FBQyxDQUFDO1FBRXBFLE9BQU8sUUFBUSxDQUFDO0lBQ3BCLENBQUM7SUFDTyxvQkFBb0IsQ0FBQyxPQUFrQjtRQUMzQyxNQUFNLElBQUksR0FBRyxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUMsT0FBTyxDQUFRLENBQUMsQ0FBQztRQUN0RCxPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDO0lBQ08seUJBQXlCLENBQUMsT0FBa0I7UUFDaEQsTUFBTSxTQUFTLEdBQUcsV0FBVyxDQUFDLFlBQVksQ0FBQyxDQUFDLE9BQU8sQ0FBUSxDQUFDLENBQUM7UUFDN0QsT0FBTyxTQUFTLENBQUM7SUFDckIsQ0FBQztDQUVKO0FBRUQsTUFBTSxPQUFPLGlCQUFpQjtJQVUxQjtRQUNJLElBQUksQ0FBQyxjQUFjLEdBQUcsS0FBSyxDQUFDO1FBQzVCLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUNqQixDQUFDO0lBRUQsUUFBUTtRQUNKLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNiLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO0lBQzVCLENBQUM7SUFFRCxLQUFLO1FBQ0QsSUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7UUFDekIsSUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7UUFDekIsSUFBSSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUM7UUFDdkIsSUFBSSxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUM7UUFFcEIsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQzFCLENBQUM7SUFFRCxjQUFjO1FBQ1YsSUFBSSxDQUFDLGNBQWMsR0FBRyxLQUFLLENBQUM7UUFDNUIsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7SUFDNUIsQ0FBQztJQUVELGVBQWUsQ0FBQyxTQUFrQixLQUFLO1FBQ25DLElBQUksTUFBTSxFQUFFO1lBQ1IsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7U0FDM0I7UUFDRCxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUU7WUFDbEIsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1lBQ3RCLElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDO1lBQzNCLElBQUksTUFBTSxFQUFFO2dCQUNSLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDO2FBQ3RCO1NBQ0o7SUFDTCxDQUFDO0lBRUQsV0FBVztRQUNQLElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRTtZQUNsQixJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7WUFDdEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUM7U0FDMUI7SUFDTCxDQUFDO0lBRUQsbUJBQW1CO1FBQ2YsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUM7SUFDL0IsQ0FBQztDQUNKIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUG9seWdvblV0aWwgfSBmcm9tIFwiLi9wb2x5Z29uLnV0aWxcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb2x5Z29uSW5mbyB7XHJcbiAgICBwb2x5Z29uOiBJTGF0TG5nW11bXVtdID0gW107XHJcbiAgICB0cmFzaGNhblBvaW50OiBJTGF0TG5nW10gPSBbXTtcclxuICAgIHNxbUFyZWE6IG51bWJlcltdID0gW107XHJcbiAgICBwZXJpbWV0ZXI6IG51bWJlcltdID0gW107XHJcbiAgICBjb25zdHJ1Y3Rvcihwb2x5Z29uKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJQb2x5Z29uSW5mbzogXCIsIHBvbHlnb24pO1xyXG4gICAgICAgIHBvbHlnb24uZm9yRWFjaCgocG9seWdvbnMsIGkpID0+IHsgdGhpcy50cmFzaGNhblBvaW50W2ldID0gdGhpcy5nZXRUcmFzaGNhblBvaW50KHBvbHlnb25zWzBdKTtcclxuICAgICAgICAgICAgdGhpcy5zcW1BcmVhW2ldID0gdGhpcy5jYWxjdWxhdGVQb2x5Z29uQXJlYShwb2x5Z29uc1swXSk7XHJcbiAgICAgICAgICAgIHRoaXMucGVyaW1ldGVyW2ldID0gdGhpcy5jYWxjdWxhdGVQb2x5Z29uUGVyaW1ldGVyKHBvbHlnb25zWzBdKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocG9seWdvbnNbMF0pO1xyXG4gICAgICAgICAgICB0aGlzLnBvbHlnb25baV0gPSBwb2x5Z29uc1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgXHJcbiAgICB9XHJcbiAgICBzZXRTcW1BcmVhKGFyZWE6IG51bWJlcik6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuc3FtQXJlYVswXSA9IGFyZWE7XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGdldFRyYXNoY2FuUG9pbnQocG9seWdvbjogSUxhdExuZ1tdKTogSUxhdExuZyB7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlcyA9IE1hdGgubWF4LmFwcGx5KE1hdGgsIHBvbHlnb24ubWFwKG8gPT4gby5sYXQpKTtcclxuICAgICAgICBjb25zdCBpZHggPSBwb2x5Z29uLmZpbmRJbmRleChvID0+IG8ubGF0ID09PSByZXMpO1xyXG5cclxuICAgICAgICBsZXQgcHJldmlvdXNQb2ludDogSUxhdExuZztcclxuICAgICAgICBsZXQgbmV4dFBvaW50OiBJTGF0TG5nO1xyXG5cclxuICAgICAgICBpZiAoaWR4ID4gMCkge1xyXG4gICAgICAgICAgICBwcmV2aW91c1BvaW50ID0gcG9seWdvbltpZHggLSAxXTtcclxuICAgICAgICAgICAgaWYgKGlkeCA8IHBvbHlnb24ubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgbmV4dFBvaW50ID0gcG9seWdvbltpZHggKyAxXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG5leHRQb2ludCA9IHBvbHlnb25bMF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBwcmV2aW91c1BvaW50ID0gcG9seWdvbltwb2x5Z29uLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICBuZXh0UG9pbnQgPSBwb2x5Z29uW2lkeCArIDFdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3Qgc2Vjb25kUG9pbnQgPSAocHJldmlvdXNQb2ludC5sbmcgPCBuZXh0UG9pbnQubG5nKSA/IHByZXZpb3VzUG9pbnQgOiBuZXh0UG9pbnQ7XHJcblxyXG4gICAgICAgIGNvbnN0IG1pZHBvaW50ID0gUG9seWdvblV0aWwuZ2V0TWlkUG9pbnQocG9seWdvbltpZHhdLCBzZWNvbmRQb2ludCk7XHJcblxyXG4gICAgICAgIHJldHVybiBtaWRwb2ludDtcclxuICAgIH1cclxuICAgIHByaXZhdGUgY2FsY3VsYXRlUG9seWdvbkFyZWEocG9seWdvbjogSUxhdExuZ1tdKTogbnVtYmVyIHtcclxuICAgICAgICBjb25zdCBhcmVhID0gUG9seWdvblV0aWwuZ2V0U3FtQXJlYSgocG9seWdvbikgYXMgYW55KTtcclxuICAgICAgICByZXR1cm4gYXJlYTtcclxuICAgIH1cclxuICAgIHByaXZhdGUgY2FsY3VsYXRlUG9seWdvblBlcmltZXRlcihwb2x5Z29uOiBJTGF0TG5nW10pOiBudW1iZXIge1xyXG4gICAgICAgIGNvbnN0IHBlcmltZXRlciA9IFBvbHlnb25VdGlsLmdldFBlcmltZXRlcigocG9seWdvbikgYXMgYW55KTtcclxuICAgICAgICByZXR1cm4gcGVyaW1ldGVyO1xyXG4gICAgfVxyXG4gICAgXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBQb2x5Z29uRHJhd1N0YXRlcyB7XHJcbiAgICBpc0FjdGl2YXRlZDogYm9vbGVhbjtcclxuICAgIGlzRnJlZURyYXdNb2RlOiBib29sZWFuO1xyXG4gICAgaXNNb3ZlTW9kZTogYm9vbGVhbjtcclxuICAgIGNhblJldmVydDogYm9vbGVhbjtcclxuICAgIGlzQXV0bzogYm9vbGVhbjtcclxuICAgIGhhc1BvbHlnb25zOiBib29sZWFuO1xyXG4gICAgY2FuVXNlUG9seURyYXc6IGJvb2xlYW47XHJcblxyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuY2FuVXNlUG9seURyYXcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnJlc2V0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgYWN0aXZhdGUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgICAgIHRoaXMuaXNBY3RpdmF0ZWQgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuaXNBY3RpdmF0ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmhhc1BvbHlnb25zID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jYW5SZXZlcnQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmlzQXV0byA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLnJlc2V0RHJhd01vZGVzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzZXREcmF3TW9kZXMoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5pc0ZyZWVEcmF3TW9kZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNNb3ZlTW9kZSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEZyZWVEcmF3TW9kZShpc0F1dG86IGJvb2xlYW4gPSBmYWxzZSk6IHZvaWQge1xyXG4gICAgICAgIGlmIChpc0F1dG8pIHtcclxuICAgICAgICAgICAgdGhpcy5pc0FjdGl2YXRlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmlzQWN0aXZhdGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzZXREcmF3TW9kZXMoKTtcclxuICAgICAgICAgICAgdGhpcy5pc0ZyZWVEcmF3TW9kZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmIChpc0F1dG8pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNBdXRvID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRNb3ZlTW9kZSgpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5pc0FjdGl2YXRlZCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlc2V0RHJhd01vZGVzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNNb3ZlTW9kZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZvcmNlQ2FuVXNlRnJlZURyYXcoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jYW5Vc2VQb2x5RHJhdyA9IHRydWU7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUxhdExuZyB7XHJcbiAgICBsYXQ6IG51bWJlciwgXHJcbiAgICBsbmc6IG51bWJlcjtcclxufSJdfQ==